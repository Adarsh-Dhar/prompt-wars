# Requirements Document

## Introduction

The Contrarian Agent is an AI-powered counter-trading bot for the RektOrRich Solana dApp that implements contrarian investment strategies. The agent fetches real-time market sentiment data and generates trading signals that oppose the majority market opinion, embodying the "Inverse Cramer" meme philosophy. Users can pay to access the agent's reasoning and place prediction bets on whether the agent's contrarian calls will be profitable.

## Glossary

- **Contrarian_Agent**: The AI trading bot that generates counter-trend trading signals
- **Fear_and_Greed_Index**: A market sentiment indicator from api.alternative.me ranging from 0-100
- **Community_Sentiment**: Token-specific sentiment data from CoinGecko API
- **Smug_Rant**: The agent's arrogant reasoning explanation for its trading decision
- **x402_Payment**: HTTP 402 payment protocol for accessing premium content
- **RektOrRich_dApp**: The Solana-based prediction market application
- **Trading_Signal**: BUY or SELL recommendation generated by the agent
- **Prediction_Market**: Betting mechanism where users wager on agent performance

## Requirements

### Requirement 1

**User Story:** As a trader, I want the Contrarian Agent to fetch real-time market sentiment data, so that I can see contrarian trading opportunities based on current market psychology.

#### Acceptance Criteria

1. WHEN the Contrarian_Agent executes its analysis cycle THEN the system SHALL fetch the current Fear and Greed Index from api.alternative.me
2. WHEN the Contrarian_Agent requests sentiment data THEN the system SHALL retrieve Community_Sentiment for the specified token from CoinGecko API
3. WHEN API calls are made THEN the system SHALL handle network errors gracefully and retry failed requests up to 3 times
4. WHEN sentiment data is retrieved THEN the system SHALL validate that Fear_and_Greed_Index values are between 0-100
5. WHEN sentiment data is cached THEN the system SHALL refresh the data every 5 minutes to ensure accuracy

### Requirement 2

**User Story:** As a contrarian trader, I want the agent to generate trading signals that oppose market sentiment, so that I can capitalize on crowd psychology reversals.

#### Acceptance Criteria

1. WHEN Fear_and_Greed_Index exceeds 60 THEN the Contrarian_Agent SHALL generate a SELL Trading_Signal
2. WHEN Fear_and_Greed_Index is 60 or below THEN the Contrarian_Agent SHALL generate a BUY Trading_Signal
3. WHEN Community_Sentiment is bullish above 70% THEN the Contrarian_Agent SHALL reinforce SELL signals
4. WHEN Community_Sentiment is bearish below 30% THEN the Contrarian_Agent SHALL reinforce BUY signals
5. WHEN generating signals THEN the system SHALL output structured JSON format compatible with the frontend

### Requirement 3

**User Story:** As a user, I want to access the agent's reasoning through x402 payments, so that I can understand the logic behind contrarian trading decisions.

#### Acceptance Criteria

1. WHEN a user requests the Smug_Rant THEN the system SHALL require x402_Payment verification before revealing content
2. WHEN payment is verified THEN the system SHALL decrypt and display the agent's reasoning
3. WHEN generating reasoning THEN the Contrarian_Agent SHALL use arrogant, superior tone with phrases like "sheep" and "retail"
4. WHEN extreme market conditions exist THEN the agent SHALL include specific contrarian catchphrases in the Smug_Rant
5. WHEN content is accessed THEN the system SHALL log the payment transaction for audit purposes

### Requirement 4

**User Story:** As a prediction market participant, I want to bet on the agent's performance, so that I can profit from correctly predicting contrarian trade outcomes.

#### Acceptance Criteria

1. WHEN the agent generates a Trading_Signal THEN the system SHALL create two betting options for users
2. WHEN users place bets THEN the system SHALL offer "Knife Catcher" option for early/wrong timing predictions
3. WHEN users place bets THEN the system SHALL offer "Alpha God" option for perfect timing predictions
4. WHEN betting markets are created THEN the system SHALL integrate with the existing RektOrRich_dApp prediction infrastructure
5. WHEN trades are executed THEN the system SHALL track agent performance for settlement purposes

### Requirement 5

**User Story:** As a developer, I want the agent to integrate seamlessly with the existing codebase, so that it follows established patterns and maintains system consistency.

#### Acceptance Criteria

1. WHEN implementing the agent THEN the system SHALL create the module at src/agents/contrarian.ts
2. WHEN the agent is instantiated THEN the system SHALL follow the same interface patterns as existing agents
3. WHEN the agent communicates THEN the system SHALL use the established frontend integration protocols
4. WHEN errors occur THEN the system SHALL use the existing error handling and logging mechanisms
5. WHEN the agent operates THEN the system SHALL maintain compatibility with the current x402 payment infrastructure

### Requirement 6

**User Story:** As a system administrator, I want the agent to handle extreme market conditions appropriately, so that it provides reliable contrarian signals during high volatility periods.

#### Acceptance Criteria

1. WHEN Fear_and_Greed_Index reaches extreme fear levels above 80 THEN the Contrarian_Agent SHALL trigger aggressive BUY signals
2. WHEN Fear_and_Greed_Index reaches extreme greed levels above 80 THEN the Contrarian_Agent SHALL trigger aggressive SELL signals
3. WHEN extreme conditions are detected THEN the agent SHALL adjust its confidence levels and reasoning intensity
4. WHEN market data is unavailable THEN the system SHALL use cached data with appropriate staleness warnings
5. WHEN API rate limits are encountered THEN the system SHALL implement exponential backoff retry strategies